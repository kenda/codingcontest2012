{% extends "base.html" %}

{% block jquery %}{% endblock %}
{% block head_extra %}

<link href="/api/v1/buch/?format=jsonp&username=admin&api_key=00405cc4d92866272602ef2f476f97b6e4f266f9" type="application/jsonp" rel="exhibit/data" ex:converter="converter"/>
<script src="http://api.simile-widgets.org/exhibit/2.2.0/exhibit-api.js" type="text/javascript"></script>
<script src="http://static.simile.mit.edu/exhibit/extensions-2.0/time/time-extension.js"></script>
<script type="text/javascript">
  // Exhibit modifiziert den Seitentitel standardmäßig unschön, durch
  // Überschreiben der Funktion wird dies verhindert.
      SimileAjax.History.formatHistoryEntryTitle = function(actionLabel) {
	  return SimileAjax.History._plainDocumentTitle;
      }
  
/**
 * Diese Funktion wandelt das von der REST-Schnittstelle
 * erhaltene JSON in das für Exhibit benötigte spezifische
 * JSON-Format um.
 **/
function converter(json){
    json.items = json.objects;
    delete json.objects;
    for (item in json.items){
	json.items[item].label = json.items[item].titel;
	delete json.items[item].titel;
    }
    json.properties = {
	'label': {
	    label: "Titel"
	},
	'autor': {
	    label: "Autor"
	},
	'veroeffentlichung': {
	    label: "Veröffentlichung",
	    valueType: "date"
	},
	'verlag': {
	    label: "Verlag"
	},
	'isbn': {
	    label: "ISBN",
	},
	'bemerkung': {
	    label: "Bemerkung"
	},
	'preis': {
	    label: "Preis"
	},
	'lesezeichen': {
	    label: "Lesezeichen"
	},
	'bewertung': {
	    valueType: "number",
	    label: "Bewertung"
	}
    };
    console.log(json);
    return json;
}
$(document).ready(function() {
$("table.exhibit-tabularView-body").addClass("sortable striped");

});
</script>

{% endblock %}
    
{% block content %}

<div class="col_2">
  <!-- Menu Vertical Left -->
  <ul class="menu vertical">
    <li class="current"><a href="/">&Uuml;bersicht</a></li>
    <li><a href="">Wunschliste</a></li>
    <li><a href="/stats/">Statistiken</a></li>
    <li><a href="/export/">Export</a></li>
  </ul>
</div>

<div class="col_7">
  <a class="button orange" href="/add/">
    <span class="icon medium" data-icon="+"></span>neues Buch
  </a>

  <div ex:role="viewPanel">
    <div ex:role="view" ex:showHeader="false" ex:paginate="true" style="padding: 1em 0.5in;"></div>
    <div ex:role="view" ex:viewClass="Tabular"
	 ex:columns=".label, .autor, .verlag, .genre, .veroeffentlichung, .bewertung, .preis, .lesezeichen" >
    </div>
    <div ex:role="view" 
	 ex:viewClass="Timeline" 
	 ex:start=".veroeffentlichung"
	 ex:end=".veroeffentlichung">
    </div>
  </div>
</div>

<div class="col_3">
   <div ex:role="facet" 
	ex:facetClass="TextSearch"
	ex:faceLabel="Volltext-Suche">
   </div><br/>

   <div ex:role="facet" 
	ex:facetClass="Cloud"
	ex:expression=".autor"
	ex:facetLabel="Autoren" >
   </div><br/>
   
   <div ex:role="facet" 
	ex:facetClass="Cloud"
	ex:expression=".verlag"
	ex:facetLabel="Verlage" >
   </div><br/>

   <div ex:role="facet" 
	ex:expression=".bewertung"
	ex:facetClass="Slider" 
	ex:horizontal="true"
	ex:precision="0.5"
	ex:histogram="false"
	ex:facetLabel="Bewertung">
   </div>


</div>
{% endblock %}
